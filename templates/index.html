{% extends "base.html" %}
{% block content %}

<!-- Hero Section with Quantum Animation -->
<div class="hero-container position-relative overflow-hidden text-white text-center bg-dark">
  <div id="quantum-particles"></div>
  <div class="hero-content d-flex flex-column justify-content-center align-items-center py-5">
    <h1 class="display-3 fw-bold hero-title mb-3 animate-fade-in-up">
      Quantum Field Kit
    </h1>
    <p class="lead hero-subtitle animate-fade-in-up-delayed mx-auto">
      A high-fidelity quantum computing simulation platform for exploring quantum protocols,
      algorithms, and concepts with scientific accuracy.
    </p>
    <div class="d-flex gap-3 mt-4 animate-fade-in-up-delayed2">
      <a href="#plugin-categories" class="btn btn-lg btn-primary smooth-scroll">
        <i class="fas fa-flask me-2"></i> Explore Simulations
      </a>
      <a href="https://github.com/ParleSec/QuantumFieldKit" target="_blank" rel="noopener noreferrer" class="btn btn-lg btn-outline-light">
        <i class="fab fa-github me-2"></i> View Source
      </a>
    </div>
  </div>
</div>

<!-- Interactive Bloch Sphere Demo -->
<div class="container mt-5 mb-5">
  <div class="row align-items-center">
    <div class="col-lg-6 mb-4 mb-lg-0">
      <div id="bloch-sphere-container" class="demo-container bg-dark rounded shadow-sm"></div>
    </div>
    <div class="col-lg-6">
      <h2 class="mb-3 fw-bold">Interactive Quantum Visualizations</h2>
      <p class="lead mb-4">
        Experience quantum mechanics through intuitive, interactive visualizations.
        Explore quantum states on the Bloch sphere, analyze circuit diagrams, and visualize
        probability distributions.
      </p>
      <div class="d-flex mt-3 flex-wrap gap-2">
        <button id="setState-plus" class="btn btn-outline-primary">|+⟩ State</button>
        <button id="setState-minus" class="btn btn-outline-primary">|-⟩ State</button>
        <button id="setState-zero" class="btn btn-outline-primary">|0⟩ State</button>
        <button id="setState-one" class="btn btn-outline-primary">|1⟩ State</button>
        <button id="setState-plus-i" class="btn btn-outline-primary">|+i⟩ State</button>
        <button id="setState-minus-i" class="btn btn-outline-primary">|-i⟩ State</button>
      </div>
    </div>
  </div>
</div>

<!-- Plugin Categories Section -->
<div class="container-fluid bg-light py-5" id="plugin-categories">
  <div class="container">
    <h2 class="text-center mb-5 fw-bold">Quantum Simulations by Category</h2>
    
    <div class="row g-4">
      {% for category, plugins in categories.items() %}
        <div class="col-12">
          <h3 class="border-bottom pb-2 mb-3 text-capitalize">
            {% if category == 'protocols' %}
              <i class="fas fa-exchange-alt me-2"></i>
            {% elif category == 'cryptography' %}
              <i class="fas fa-lock me-2"></i>
            {% elif category == 'algorithms' %}
              <i class="fas fa-code-branch me-2"></i>
            {% elif category == 'error-correction' %}
              <i class="fas fa-shield-alt me-2"></i>
            {% elif category == 'utilities' %}
              <i class="fas fa-tools me-2"></i>
            {% elif category == 'security' %}
              <i class="fas fa-user-shield me-2"></i>
            {% else %}
              <i class="fas fa-atom me-2"></i>
            {% endif %}
            {{ category | replace('-', ' ') | title }}
          </h3>
        </div>
        
        {% for plugin in plugins %}
          <div class="col-md-6 col-lg-4">
            <div class="card h-100 plugin-card tilt-card border-0 shadow-sm">
              <div class="card-body d-flex flex-column">
                <div class="d-flex align-items-center mb-3">
                  <div class="icon-wrapper rounded-circle bg-primary d-flex align-items-center justify-content-center me-3">
                    <i class="fas {{ plugin.icon }} fa-fw text-white"></i>
                  </div>
                  <h5 class="card-title mb-0">{{ plugin.name }}</h5>
                </div>
                <p class="card-text text-muted mb-4 flex-grow-1">{{ plugin.description }}</p>
                <a href="{{ url_for('plugin_view', plugin_key=plugin.key) }}" class="btn btn-primary">
                  Run Simulation <i class="fas fa-chevron-right ms-1"></i>
                </a>
              </div>
            </div>
          </div>
        {% endfor %}
      {% endfor %}
    </div>
  </div>
</div>

<!-- Education Section -->
<div class="container my-5">
  <div class="row g-4">
    <div class="col-lg-6">
      <h2 class="fw-bold mb-4">Understanding Quantum Computing</h2>
      <p class="lead">
        Quantum Field Kit provides a bridge between theoretical quantum physics and
        practical simulations. Our high-fidelity models accurately represent quantum behavior.
      </p>
      <div class="accordion mt-4" id="quantumAccordion">
        <div class="accordion-item">
          <h2 class="accordion-header" id="headingOne">
            <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
              Quantum Superposition
            </button>
          </h2>
          <div id="collapseOne" class="accordion-collapse collapse show" aria-labelledby="headingOne" data-bs-parent="#quantumAccordion">
            <div class="accordion-body">
              Superposition allows quantum bits (qubits) to exist in multiple states simultaneously, 
              unlike classical bits that can only be 0 or 1. This property enables quantum computers 
              to process vast amounts of information in parallel.
            </div>
          </div>
        </div>
        <div class="accordion-item">
          <h2 class="accordion-header" id="headingTwo">
            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
              Quantum Entanglement
            </button>
          </h2>
          <div id="collapseTwo" class="accordion-collapse collapse" aria-labelledby="headingTwo" data-bs-parent="#quantumAccordion">
            <div class="accordion-body">
              Entanglement creates a special connection between qubits where the state of one qubit 
              instantaneously affects its entangled partner, regardless of the distance separating them. 
              Einstein famously called this "spooky action at a distance."
            </div>
          </div>
        </div>
        <div class="accordion-item">
          <h2 class="accordion-header" id="headingThree">
            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseThree" aria-expanded="false" aria-controls="collapseThree">
              Quantum Gates and Circuits
            </button>
          </h2>
          <div id="collapseThree" class="accordion-collapse collapse" aria-labelledby="headingThree" data-bs-parent="#quantumAccordion">
            <div class="accordion-body">
              Quantum algorithms are implemented using quantum gates that manipulate qubits. 
              Unlike classical logic gates, quantum gates are reversible and preserve quantum information. 
              Common gates include the Hadamard gate (creating superposition) and CNOT gate (creating entanglement).
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="col-lg-6">
      <div class="ratio ratio-16x9 h-100 d-flex align-items-center justify-content-center bg-dark rounded shadow-sm">
        <div id="circuit-demo-container" class="p-3 w-100 h-100"></div>
      </div>
    </div>
  </div>
</div>

<!-- Call to Action -->
<div class="bg-primary text-white py-5 text-center">
  <div class="container">
    <h2 class="fw-bold mb-3">Ready to explore quantum computing?</h2>
    <p class="lead mb-4">Choose a simulation from our extensive collection and witness quantum mechanics in action.</p>
    <a href="#plugin-categories" class="btn btn-lg btn-light smooth-scroll">
      <i class="fas fa-flask me-2"></i> Get Started
    </a>
  </div>
</div>

{% endblock %}

{% block extra_scripts %}
<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/dat-gui/0.7.7/dat.gui.min.js"></script>
<script src="{{ url_for('static', filename='js/OrbitControls.js') }}"></script>
<script src="{{ url_for('static', filename='js/quantum-visualization.js') }}"></script>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    // Initialize Bloch sphere
    const blochSphere = new quantumViz.BlochSphere('bloch-sphere-container');
    
    // Set up state buttons
    document.getElementById('setState-plus').addEventListener('click', () => {
      blochSphere.setStateByAngles(Math.PI/2, 0); // |+⟩ state
    });
    
    document.getElementById('setState-minus').addEventListener('click', () => {
      blochSphere.setStateByAngles(Math.PI/2, Math.PI); // |-⟩ state
    });
    
    document.getElementById('setState-zero').addEventListener('click', () => {
      blochSphere.setStateByAngles(0, 0); // |0⟩ state
    });
    
    document.getElementById('setState-one').addEventListener('click', () => {
      blochSphere.setStateByAngles(Math.PI, 0); // |1⟩ state
    });
    
    document.getElementById('setState-plus-i').addEventListener('click', () => {
      blochSphere.setStateByAngles(Math.PI/2, Math.PI/2); // |+i⟩ state
    });
    
    document.getElementById('setState-minus-i').addEventListener('click', () => {
      blochSphere.setStateByAngles(Math.PI/2, -Math.PI/2); // |-i⟩ state
    });
    
    // Initialize with |+⟩ state
    blochSphere.setStateByAngles(Math.PI/2, 0);
    
    // Initialize circuit demo
    const circuitDemo = new quantumViz.QuantumCircuitRenderer('circuit-demo-container');
    
    // Create a simple teleportation circuit for demonstration
    const demoCircuit = {
      qubits: ['q0', 'q1', 'q2'],
      gates: [
        { type: 'H', qubit: 0, time: 0 },
        { type: 'H', qubit: 1, time: 0 },
        { type: 'CNOT', control: 1, target: 2, time: 1 },
        { type: 'CNOT', control: 0, target: 1, time: 2 },
        { type: 'H', qubit: 0, time: 3 },
        { type: 'M', qubit: 0, time: 4 },
        { type: 'M', qubit: 1, time: 4 },
        { type: 'X', qubit: 2, time: 5 },
        { type: 'Z', qubit: 2, time: 6 }
      ]
    };
    
    circuitDemo.render(demoCircuit);
    
    // Initialize particles background
    initQuantumParticles();
  });
  
  function initQuantumParticles() {
    const canvas = document.createElement('canvas');
    canvas.width = window.innerWidth;
    canvas.height = 500;
    document.getElementById('quantum-particles').appendChild(canvas);
    
    const ctx = canvas.getContext('2d');
    const particles = [];
    const maxParticles = 100;
    
    // Create initial particles
    for (let i = 0; i < maxParticles; i++) {
      particles.push({
        x: Math.random() * canvas.width,
        y: Math.random() * canvas.height,
        size: Math.random() * 3 + 1,
        speed: Math.random() * 1 + 0.5,
        color: `rgba(64, 186, 255, ${Math.random() * 0.5 + 0.2})`,
        connected: []
      });
    }
    
    // Connect nearby particles
    function connectParticles() {
      for (let i = 0; i < particles.length; i++) {
        particles[i].connected = [];
        for (let j = 0; j < particles.length; j++) {
          if (i !== j) {
            const dx = particles[i].x - particles[j].x;
            const dy = particles[i].y - particles[j].y;
            const distance = Math.sqrt(dx * dx + dy * dy);
            
            if (distance < 100) {
              particles[i].connected.push({
                particle: j,
                distance: distance
              });
            }
          }
        }
      }
    }
    
    // Animation loop
    function animate() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      
      // Update and draw particles
      for (let i = 0; i < particles.length; i++) {
        const p = particles[i];
        
        // Update position
        p.y -= p.speed;
        if (p.y < -10) {
          p.y = canvas.height + 10;
          p.x = Math.random() * canvas.width;
        }
        
        // Draw particle
        ctx.beginPath();
        ctx.arc(p.x, p.y, p.size, 0, Math.PI * 2);
        ctx.fillStyle = p.color;
        ctx.fill();
        
        // Draw connections
        for (const connection of p.connected) {
          const other = particles[connection.particle];
          const opacity = 1 - connection.distance / 100;
          
          ctx.beginPath();
          ctx.moveTo(p.x, p.y);
          ctx.lineTo(other.x, other.y);
          ctx.strokeStyle = `rgba(64, 186, 255, ${opacity * 0.2})`;
          ctx.lineWidth = 0.5;
          ctx.stroke();
        }
      }
      
      // Update connections periodically
      if (Math.random() > 0.95) {
        connectParticles();
      }
      
      requestAnimationFrame(animate);
    }
    
    // Initial connection setup
    connectParticles();
    
    // Start animation
    animate();
    
    // Handle window resize
    window.addEventListener('resize', function() {
      canvas.width = window.innerWidth;
      canvas.height = 500;
      connectParticles();
    });
  }
</script>
{% endblock %}